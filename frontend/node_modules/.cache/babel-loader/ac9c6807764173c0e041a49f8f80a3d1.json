{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\khanh\\\\workspace\\\\commeun\\\\frontend\\\\src\\\\views\\\\TopicView.js\";\nimport React, { Component } from \"react\";\nimport Post from \"../components/Post\";\nimport AddPost from \"../components/AddPost\";\nimport EditPost from \"../components/EditPost\";\nimport \"./TopicView.css\";\nimport Cookies from \"universal-cookie\";\nconst cookies = new Cookies();\n\nclass TopicView extends Component {\n  constructor(_id) {\n    super(_id);\n    this.state = {\n      data: null,\n      user: cookies.get(\"user\"),\n      edit: false,\n      editId: null\n    };\n\n    this.getDataFromDb = () => {\n      // console.log(\"Je me refresh\");\n      // let url = \"http://localhost:4000/topics/\" + this.id;\n      // let url = \"https://testkhannea.herokuapp.com/topics/\" + this.id;\n      let url = \"/api/topics/\" + this.id;\n      let req = new Request(url, {\n        method: \"GET\",\n        cache: \"default\",\n        credentials: \"include\"\n      });\n      fetch(req).then(res => {\n        // console.log(res)\n        if (res.status === 401) {\n          console.log(\"TopicView n'a pas recu les topics.\");\n        } else {\n          // console.log(\"TopicView  a bien recu les topics.\");\n          return res.json();\n        }\n      }).then(data => {\n        // console.log(data);\n        this.setState({\n          data: data\n        });\n      });\n    };\n\n    this.goOnEdit = id => {\n      console.log(\"ID edit: \" + id);\n      this.setState({\n        edit: true,\n        editId: id\n      });\n    };\n\n    this.goOncancelEdit = () => {\n      this.setState({\n        edit: false,\n        editId: null\n      });\n    };\n\n    this.id = _id.location.pathname.split(\"/\")[2];\n  }\n\n  componentDidMount() {\n    this.getDataFromDb();\n  }\n\n  render() {\n    let myid = this.id;\n    let data = this.state.data;\n    return React.createElement(\"div\", {\n      className: \"topicview\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"posts_box mx-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, data && data.map(({\n      user,\n      texte,\n      date,\n      id,\n      likes,\n      dislikes\n    }, index) => React.createElement(\"div\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(Post, {\n      user: user,\n      texte: texte,\n      date: date,\n      key: index,\n      id: id,\n      likes: likes,\n      dislikes: dislikes,\n      refresh: this.getDataFromDb,\n      editfunction: this.goOnEdit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    })))), !this.state.edit && React.createElement(\"div\", {\n      className: \"border-top\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(AddPost, {\n      id: myid,\n      refresh: this.getDataFromDb,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    })), this.state.edit && React.createElement(\"div\", {\n      className: \"border-top border-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(EditPost, {\n      id: this.state.editId,\n      cancelEdit: this.goOncancelEdit,\n      refresh: this.getDataFromDb,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default TopicView;","map":{"version":3,"sources":["C:/Users/khanh/workspace/commeun/frontend/src/views/TopicView.js"],"names":["React","Component","Post","AddPost","EditPost","Cookies","cookies","TopicView","constructor","id","state","data","user","get","edit","editId","getDataFromDb","url","req","Request","method","cache","credentials","fetch","then","res","status","console","log","json","setState","goOnEdit","goOncancelEdit","location","pathname","split","componentDidMount","render","myid","map","texte","date","likes","dislikes","index"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AAEA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,OAAO,iBAAP;AAEA,OAAOC,OAAP,MAAoB,kBAApB;AAEA,MAAMC,OAAO,GAAG,IAAID,OAAJ,EAAhB;;AAEA,MAAME,SAAN,SAAwBN,SAAxB,CAAkC;AAOhCO,EAAAA,WAAW,CAACC,GAAD,EAAK;AACd,UAAMA,GAAN;AADc,SANhBC,KAMgB,GANR;AACNC,MAAAA,IAAI,EAAE,IADA;AAENC,MAAAA,IAAI,EAAEN,OAAO,CAACO,GAAR,CAAY,MAAZ,CAFA;AAGNC,MAAAA,IAAI,EAAE,KAHA;AAINC,MAAAA,MAAM,EAAE;AAJF,KAMQ;;AAAA,SAShBC,aATgB,GASA,MAAM;AACpB;AACA;AACA;AACA,UAAIC,GAAG,GAAG,iBAAiB,KAAKR,EAAhC;AACA,UAAIS,GAAG,GAAG,IAAIC,OAAJ,CAAYF,GAAZ,EAAiB;AACzBG,QAAAA,MAAM,EAAE,KADiB;AAEzBC,QAAAA,KAAK,EAAE,SAFkB;AAGzBC,QAAAA,WAAW,EAAE;AAHY,OAAjB,CAAV;AAKAC,MAAAA,KAAK,CAACL,GAAD,CAAL,CACGM,IADH,CACQC,GAAG,IAAI;AACX;AACA,YAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACtBC,UAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACD,SAFD,MAEO;AACL;AACA,iBAAOH,GAAG,CAACI,IAAJ,EAAP;AACD;AACF,OATH,EAUGL,IAVH,CAUQb,IAAI,IAAI;AACZ;AACA,aAAKmB,QAAL,CAAc;AACZnB,UAAAA,IAAI,EAAEA;AADM,SAAd;AAGD,OAfH;AAgBD,KAnCe;;AAAA,SAqChBoB,QArCgB,GAqCLtB,EAAE,IAAI;AACfkB,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAcnB,EAA1B;AACA,WAAKqB,QAAL,CAAc;AACZhB,QAAAA,IAAI,EAAE,IADM;AAEZC,QAAAA,MAAM,EAAEN;AAFI,OAAd;AAID,KA3Ce;;AAAA,SA6ChBuB,cA7CgB,GA6CC,MAAM;AACrB,WAAKF,QAAL,CAAc;AACZhB,QAAAA,IAAI,EAAE,KADM;AAEZC,QAAAA,MAAM,EAAE;AAFI,OAAd;AAID,KAlDe;;AAEd,SAAKN,EAAL,GAAUA,GAAE,CAACwB,QAAH,CAAYC,QAAZ,CAAqBC,KAArB,CAA2B,GAA3B,EAAgC,CAAhC,CAAV;AACD;;AAEDC,EAAAA,iBAAiB,GAAG;AAClB,SAAKpB,aAAL;AACD;;AA6CDqB,EAAAA,MAAM,GAAG;AACP,QAAIC,IAAI,GAAG,KAAK7B,EAAhB;AADO,QAEDE,IAFC,GAEQ,KAAKD,KAFb,CAEDC,IAFC;AAGP,WACE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGA,IAAI,IACHA,IAAI,CAAC4B,GAAL,CAAS,CAAC;AAAE3B,MAAAA,IAAF;AAAQ4B,MAAAA,KAAR;AAAeC,MAAAA,IAAf;AAAqBhC,MAAAA,EAArB;AAAyBiC,MAAAA,KAAzB;AAAgCC,MAAAA;AAAhC,KAAD,EAA6CC,KAA7C,KACP;AAAK,MAAA,GAAG,EAAEA,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AACE,MAAA,IAAI,EAAEhC,IADR;AAEE,MAAA,KAAK,EAAE4B,KAFT;AAGE,MAAA,IAAI,EAAEC,IAHR;AAIE,MAAA,GAAG,EAAEG,KAJP;AAKE,MAAA,EAAE,EAAEnC,EALN;AAME,MAAA,KAAK,EAAEiC,KANT;AAOE,MAAA,QAAQ,EAAEC,QAPZ;AAQE,MAAA,OAAO,EAAE,KAAK3B,aARhB;AASE,MAAA,YAAY,EAAE,KAAKe,QATrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CAFJ,CADF,EAmBG,CAAC,KAAKrB,KAAL,CAAWI,IAAZ,IACC;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,OAAD;AAAS,MAAA,EAAE,EAAEwB,IAAb;AAAmB,MAAA,OAAO,EAAE,KAAKtB,aAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CApBJ,EAwBG,KAAKN,KAAL,CAAWI,IAAX,IACC;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,QAAD;AACE,MAAA,EAAE,EAAE,KAAKJ,KAAL,CAAWK,MADjB;AAEE,MAAA,UAAU,EAAE,KAAKiB,cAFnB;AAGE,MAAA,OAAO,EAAE,KAAKhB,aAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAzBJ,CADF;AAoCD;;AAlG+B;;AAqGlC,eAAeT,SAAf","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport Post from \"../components/Post\";\r\nimport AddPost from \"../components/AddPost\";\r\nimport EditPost from \"../components/EditPost\";\r\nimport \"./TopicView.css\";\r\n\r\nimport Cookies from \"universal-cookie\";\r\n\r\nconst cookies = new Cookies();\r\n\r\nclass TopicView extends Component {\r\n  state = {\r\n    data: null,\r\n    user: cookies.get(\"user\"),\r\n    edit: false,\r\n    editId: null\r\n  };\r\n  constructor(id) {\r\n    super(id);\r\n    this.id = id.location.pathname.split(\"/\")[2];\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getDataFromDb();\r\n  }\r\n\r\n  getDataFromDb = () => {\r\n    // console.log(\"Je me refresh\");\r\n    // let url = \"http://localhost:4000/topics/\" + this.id;\r\n    // let url = \"https://testkhannea.herokuapp.com/topics/\" + this.id;\r\n    let url = \"/api/topics/\" + this.id;\r\n    let req = new Request(url, {\r\n      method: \"GET\",\r\n      cache: \"default\",\r\n      credentials: \"include\"\r\n    });\r\n    fetch(req)\r\n      .then(res => {\r\n        // console.log(res)\r\n        if (res.status === 401) {\r\n          console.log(\"TopicView n'a pas recu les topics.\");\r\n        } else {\r\n          // console.log(\"TopicView  a bien recu les topics.\");\r\n          return res.json();\r\n        }\r\n      })\r\n      .then(data => {\r\n        // console.log(data);\r\n        this.setState({\r\n          data: data\r\n        });\r\n      });\r\n  };\r\n\r\n  goOnEdit = id => {\r\n    console.log(\"ID edit: \" + id);\r\n    this.setState({\r\n      edit: true,\r\n      editId: id\r\n    });\r\n  };\r\n\r\n  goOncancelEdit = () => {\r\n    this.setState({\r\n      edit: false,\r\n      editId: null\r\n    });\r\n  };\r\n\r\n  render() {\r\n    let myid = this.id;\r\n    let { data } = this.state;\r\n    return (\r\n      <div className=\"topicview\">\r\n        <div className=\"posts_box mx-auto\">\r\n          {data &&\r\n            data.map(({ user, texte, date, id, likes, dislikes }, index) => (\r\n              <div key={index}>\r\n                <Post\r\n                  user={user}\r\n                  texte={texte}\r\n                  date={date}\r\n                  key={index}\r\n                  id={id}\r\n                  likes={likes}\r\n                  dislikes={dislikes}\r\n                  refresh={this.getDataFromDb}\r\n                  editfunction={this.goOnEdit}\r\n                />\r\n              </div>\r\n            ))}\r\n        </div>\r\n        {!this.state.edit && (\r\n          <div className=\"border-top\">\r\n            <AddPost id={myid} refresh={this.getDataFromDb} />\r\n          </div>\r\n        )}\r\n        {this.state.edit && (\r\n          <div className=\"border-top border-light\">\r\n            <EditPost\r\n              id={this.state.editId}\r\n              cancelEdit={this.goOncancelEdit}\r\n              refresh={this.getDataFromDb}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TopicView;\r\n"]},"metadata":{},"sourceType":"module"}